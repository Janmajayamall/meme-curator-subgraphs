type OracleFactory @entity {
	id: ID!
	oracleCount: BigInt!
	oracles: [OracleMarkets!]! @derivedFrom(field: "factory")
}

type Market @entity {
	id: ID!

	oracle: OracleMarkets!

	creator: Bytes!
	eventIdentifier: Bytes!

	marketIdentifier: Bytes!

	# outcome reserves
	outcomeReserve0: BigDecimal!
	outcomeReserve1: BigDecimal!

	# staking reserves
	stakingReserve0: BigDecimal!
	stakingReserve1: BigDecimal!

	# market details
	tokenC: Bytes!
	feeNumerator: BigInt!
	feeDenominator: BigInt!
	# calculated
	fee: BigDecimal!

	# state details
	expireAtBlock: BigInt!
	donBufferEndsAtBlock: BigInt!
	resolutionEndsAtBlock: BigInt!
	donBufferBlocks: BigInt!
	resolutionBufferBlocks: BigInt!
	donEscalationCount: BigInt!
	donEscalationLimit: BigInt!
	outcome: BigInt!
	stage: BigInt!

	# staking
	staker0: Bytes!
	staker1: Bytes!
	lastAmountStaked: BigDecimal!
	lastOutcomeStaked: BigInt!

	users: [UserMarket!]! @derivedFrom(field: "market")
}

type User @entity {
	id: ID!
	markets: [UserMarket!]! @derivedFrom(field: "user")
}

type UserMarket @entity {
	id: ID! # {user}-{market}
	user: User!
	market: Market!
}

type OracleMarkets @entity {
	id: ID!
	delegate: Bytes!
	manager: Bytes!
	collateralToken: Bytes!
	isActive: Boolean
	feeNumerator: BigInt!
	feeDenominator: BigInt!
	donEscalationLimit: BigInt!
	expireBufferBlocks: BigInt!
	donBufferBlocks: BigInt!
	resolutionBufferBlocks: BigInt!

	markets: [Market!]! @derivedFrom(field: "oracle")

	factory: OracleFactory!
}
